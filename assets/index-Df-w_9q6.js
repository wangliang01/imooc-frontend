import{r as N,u as Q,a as B,o as D,c as u,b as s,d as C,w as V,e as _,v as f,f as e,m as y,i as h,t as v,g,h as F,j as H,k as m,l as L}from"./index-1yECeLeH.js";import{u as R,c as b,l as j,g as E}from"./index.esm-Bsb8nqZT.js";import{u as G,v as O}from"./global-BJn15Q79.js";import"./request-6j5lLKry.js";const P={class:"mt-5 layui-container fly-marginTop"},Y={class:"fly-panel fly-panel-user",pad20:""},$={class:"layui-tab layui-tab-brief","lay-filter":"user"},z={class:"layui-tab-title"},I=s("li",{class:"layui-this"},"登入",-1),J={id:"LAY_ucm",class:"layui-form layui-tab-content",style:{padding:"20px 0"}},K={class:"layui-tab-item layui-show"},W={class:"layui-form layui-form-pane"},X={method:"post"},Z={class:"layui-form-item"},ss=s("label",{for:"L_email",class:"layui-form-label"},"用户名",-1),es={class:"layui-input-inline"},ts={class:"layui-form-mid"},as={key:0,class:"text-red-600"},os={class:"layui-form-item"},is=s("label",{for:"L_pass",class:"layui-form-label"},"密码",-1),ls={class:"layui-input-inline"},ns={class:"layui-form-mid"},rs={key:0,class:"text-red-600"},ds={class:"layui-form-item"},cs={class:"layui-row"},us=s("label",{for:"code",class:"layui-form-label"},"验证码",-1),ms={class:"layui-input-inline"},ps={class:"inline-block"},_s=["innerHTML"],fs={class:"layui-form-mid"},ys={key:0,class:"text-red-600"},hs={class:"layui-form-item"},vs={style:{"padding-left":"20px"}},gs=s("div",{class:"layui-form-item fly-form-app"},[s("span",null,"或者使用社交账号登入"),s("a",{href:"",onclick:"layer.msg('正在通过QQ登入', {icon:16, shade: 0.1, time:0})",class:"iconfont icon-qq",title:"QQ登入"}),s("a",{href:"",onclick:"layer.msg('正在通过微博登入', {icon:16, shade: 0.1, time:0})",class:"iconfont icon-weibo",title:"微博登入"})],-1),Vs={__name:"index",setup(bs){const w=N(""),{defineField:p,errors:o,validate:M}=R({validationSchema:{username:b().required({message:"请输入用户名"}).email({message:"请输入正确的邮箱"}),password:b().required({message:"请输入密码"}).min(6,{message:"密码不能少于6位"}).max(16,{message:"密码不能超过16位"}),code:b().required({message:"请输入验证码"}).min(4,{message:"验证码只支持4位"}).max(4,{message:"验证码只支持4位"})}}),[i,S]=p("username",{validateOnModelUpdate:!0}),[l,T]=p("password"),[n,U]=p("code"),r=G(),x=Q(),q=B(),A=async d=>{d.preventDefault();const{valid:t}=await M();if(!t)return!1;const c={username:i.value,password:l.value,code:n.value,sid:r.sid},a=await j(c);x.setToken(a.data.token),x.setUser(a.data),q.push("/")},k=async()=>{const d=r.sid,t=await E(d);w.value=t};return D(()=>{r.sid||r.setSid(O()),k()}),(d,t)=>{const c=H("router-link");return m(),u("div",P,[s("div",Y,[s("div",$,[s("ul",z,[I,s("li",null,[C(c,{to:{name:"register"}},{default:V(()=>[L("注册")]),_:1})])]),s("div",J,[s("div",K,[s("div",W,[s("form",X,[s("div",Z,[ss,s("div",es,[_(s("input",y({"onUpdate:modelValue":t[0]||(t[0]=a=>h(i)?i.value=a:null),type:"text",name:"username"},e(S),{placeholder:"请输入用户名",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(i)]])]),s("div",ts,[e(o).username?(m(),u("span",as,v(e(o).username.message),1)):g("",!0)])]),s("div",os,[is,s("div",ls,[_(s("input",y({"onUpdate:modelValue":t[1]||(t[1]=a=>h(l)?l.value=a:null),type:"password",name:"password"},e(T),{placeholder:"请输入密码",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(l)]])]),s("div",ns,[e(o).password?(m(),u("span",rs,v(e(o).password.message),1)):g("",!0)])]),s("div",ds,[s("div",cs,[us,s("div",ms,[_(s("input",y({id:"code","onUpdate:modelValue":t[2]||(t[2]=a=>h(n)?n.value=a:null),type:"text"},e(U),{placeholder:"请输入验证码",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(n)]])]),s("div",ps,[s("span",{class:"cursor-pointer svg relative top-[-6px]",onClick:F(k,["stop"]),innerHTML:w.value},null,8,_s)])]),s("div",fs,[e(o).code?(m(),u("span",ys,v(e(o).code.message),1)):g("",!0)])]),s("div",hs,[s("button",{class:"layui-btn",type:"button",onClick:A},"立即登录"),s("span",vs,[C(c,{to:{name:"forget"}},{default:V(()=>[L("忘记密码？")]),_:1})])]),gs])])])])])])])}}};export{Vs as default};
