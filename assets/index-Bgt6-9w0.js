import{r as B,i as N,c as u,b as s,d as k,w as C,j as _,x as f,y as e,z as y,A as h,t as v,g,p as Q,B as S,a as U,o as m,f as V}from"./index-CgBtsC71.js";import{u as D,c as b,l as F,g as H}from"./index.esm-BYTWms1j.js";import{u as j,v as z}from"./global-DFA6gv5K.js";import"./request-luPZU1NW.js";const E={class:"mt-5 layui-container fly-marginTop"},G={class:"fly-panel fly-panel-user",pad20:""},O={class:"layui-tab layui-tab-brief","lay-filter":"user"},P={class:"layui-tab-title"},R=s("li",{class:"layui-this"},"登入",-1),Y={id:"LAY_ucm",class:"layui-form layui-tab-content",style:{padding:"20px 0"}},$={class:"layui-tab-item layui-show"},I={class:"layui-form layui-form-pane"},J={method:"post"},K={class:"layui-form-item"},W=s("label",{for:"L_email",class:"layui-form-label"},"用户名",-1),X={class:"layui-input-inline"},Z={class:"layui-form-mid"},ss={key:0,class:"text-red-600"},es={class:"layui-form-item"},as=s("label",{for:"L_pass",class:"layui-form-label"},"密码",-1),ts={class:"layui-input-inline"},os={class:"layui-form-mid"},is={key:0,class:"text-red-600"},ls={class:"layui-form-item"},ns={class:"layui-row"},ds=s("label",{for:"code",class:"layui-form-label"},"验证码",-1),cs={class:"layui-input-inline"},rs={class:"inline-block"},us=["innerHTML"],ms={class:"layui-form-mid"},ps={key:0,class:"text-red-600"},_s={class:"layui-form-item"},fs={style:{"padding-left":"20px"}},ys=s("div",{class:"layui-form-item fly-form-app"},[s("span",null,"或者使用社交账号登入"),s("a",{href:"",onclick:"layer.msg('正在通过QQ登入', {icon:16, shade: 0.1, time:0})",class:"iconfont icon-qq",title:"QQ登入"}),s("a",{href:"",onclick:"layer.msg('正在通过微博登入', {icon:16, shade: 0.1, time:0})",class:"iconfont icon-weibo",title:"微博登入"})],-1),xs={__name:"index",setup(hs){const w=B(""),{defineField:p,errors:t,validate:L}=D({validationSchema:{username:b().required({message:"请输入用户名"}).email({message:"请输入正确的邮箱"}),password:b().required({message:"请输入密码"}).min(6,{message:"密码不能少于6位"}).max(16,{message:"密码不能超过16位"}),code:b().required({message:"请输入验证码"}).min(4,{message:"验证码只支持4位"}).max(4,{message:"验证码只支持4位"})}}),[i,M]=p("username",{validateOnModelUpdate:!0}),[l,q]=p("password"),[n,A]=p("code"),d=j(),T=async c=>{c.preventDefault();const{valid:a}=await L();if(!a)return!1;const r={username:i.value,password:l.value,code:n.value,sid:d.sid};await F(r),S("登录成功")},x=async()=>{const c=d.sid,a=await H(c);w.value=a};return N(()=>{d.sid||d.setSid(z()),x()}),(c,a)=>{const r=U("router-link");return m(),u("div",E,[s("div",G,[s("div",O,[s("ul",P,[R,s("li",null,[k(r,{to:{name:"register"}},{default:C(()=>[V("注册")]),_:1})])]),s("div",Y,[s("div",$,[s("div",I,[s("form",J,[s("div",K,[W,s("div",X,[_(s("input",y({"onUpdate:modelValue":a[0]||(a[0]=o=>h(i)?i.value=o:null),type:"text",name:"username"},e(M),{placeholder:"请输入用户名",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(i)]])]),s("div",Z,[e(t).username?(m(),u("span",ss,v(e(t).username.message),1)):g("",!0)])]),s("div",es,[as,s("div",ts,[_(s("input",y({"onUpdate:modelValue":a[1]||(a[1]=o=>h(l)?l.value=o:null),type:"password",name:"password"},e(q),{placeholder:"请输入密码",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(l)]])]),s("div",os,[e(t).password?(m(),u("span",is,v(e(t).password.message),1)):g("",!0)])]),s("div",ls,[s("div",ns,[ds,s("div",cs,[_(s("input",y({id:"code","onUpdate:modelValue":a[2]||(a[2]=o=>h(n)?n.value=o:null),type:"text"},e(A),{placeholder:"请输入验证码",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(n)]])]),s("div",rs,[s("span",{class:"cursor-pointer svg relative top-[-6px]",onClick:Q(x,["stop"]),innerHTML:w.value},null,8,us)])]),s("div",ms,[e(t).code?(m(),u("span",ps,v(e(t).code.message),1)):g("",!0)])]),s("div",_s,[s("button",{class:"layui-btn",type:"button",onClick:T},"立即登录"),s("span",fs,[k(r,{to:{name:"forget"}},{default:C(()=>[V("忘记密码？")]),_:1})])]),ys])])])])])])])}}};export{xs as default};
