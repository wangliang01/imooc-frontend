import{r as N,k as Q,l as S,c as u,b as s,d as k,w as C,i as p,m as f,u as e,p as y,q as h,t as v,g,s as U,a as B,o as m,f as L}from"./index-_5IH-Uls.js";import{u as D,c as b,l as F,g as H}from"./index.esm-7nJOlkC8.js";import{u as E,v as G}from"./global-CsM2oEmO.js";const I={class:"mt-5 layui-container fly-marginTop"},O={class:"fly-panel fly-panel-user",pad20:""},P={class:"layui-tab layui-tab-brief","lay-filter":"user"},R={class:"layui-tab-title"},Y=s("li",{class:"layui-this"},"登入",-1),$={class:"layui-form layui-tab-content",id:"LAY_ucm",style:{padding:"20px 0"}},j={class:"layui-tab-item layui-show"},z={class:"layui-form layui-form-pane"},J={method:"post"},K={class:"layui-form-item"},W=s("label",{for:"L_email",class:"layui-form-label"},"用户名",-1),X={class:"layui-input-inline"},Z={class:"layui-form-mid"},ss={key:0,class:"text-red-600"},es={class:"layui-form-item"},as=s("label",{for:"L_pass",class:"layui-form-label"},"密码",-1),ts={class:"layui-input-inline"},os={class:"layui-form-mid"},is={key:0,class:"text-red-600"},ls={class:"layui-form-item"},ns={class:"layui-row"},ds=s("label",{for:"L_vercode",class:"layui-form-label"},"验证码",-1),cs={class:"layui-input-inline"},rs={class:""},us=["innerHTML"],ms={class:"layui-form-mid"},_s={key:0,class:"text-red-600"},ps={class:"layui-form-item"},fs={style:{"padding-left":"20px"}},ys=s("div",{class:"layui-form-item fly-form-app"},[s("span",null,"或者使用社交账号登入"),s("a",{href:"",onclick:"layer.msg('正在通过QQ登入', {icon:16, shade: 0.1, time:0})",class:"iconfont icon-qq",title:"QQ登入"}),s("a",{href:"",onclick:"layer.msg('正在通过微博登入', {icon:16, shade: 0.1, time:0})",class:"iconfont icon-weibo",title:"微博登入"})],-1),ws={__name:"index",setup(hs){const w=N("");Q();const{defineField:_,errors:t,validate:V}=D({validationSchema:{username:b().required({message:"请输入用户名"}).email({message:"请输入正确的邮箱"}),password:b().required({message:"请输入密码"}).min(6,{message:"密码不能少于6位"}).max(16,{message:"密码不能超过16位"}),code:b().required({message:"请输入验证码"}).min(4,{message:"验证码只支持4位"}).max(4,{message:"验证码只支持4位"})}}),[i,q]=_("username",{validateOnModelUpdate:!0}),[l,M]=_("password"),[n,T]=_("code"),d=E(),A=async c=>{c.preventDefault();const{valid:a}=await V();if(!a)return!1;const r={username:i.value,password:l.value,code:n.value,sid:d.sid};await F(r),U("登录成功")},x=async()=>{const c=d.sid,a=await H(c);w.value=a};return S(()=>{d.sid||d.setSid(G()),x()}),(c,a)=>{const r=B("router-link");return m(),u("div",I,[s("div",O,[s("div",P,[s("ul",R,[Y,s("li",null,[k(r,{to:{name:"register"}},{default:C(()=>[L("注册")]),_:1})])]),s("div",$,[s("div",j,[s("div",z,[s("form",J,[s("div",K,[W,s("div",X,[p(s("input",y({type:"text",name:"username","onUpdate:modelValue":a[0]||(a[0]=o=>h(i)?i.value=o:null)},e(q),{placeholder:"请输入用户名",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(i)]])]),s("div",Z,[e(t).username?(m(),u("span",ss,v(e(t).username.message),1)):g("",!0)])]),s("div",es,[as,s("div",ts,[p(s("input",y({type:"password",name:"password","onUpdate:modelValue":a[1]||(a[1]=o=>h(l)?l.value=o:null)},e(M),{placeholder:"请输入密码",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(l)]])]),s("div",os,[e(t).password?(m(),u("span",is,v(e(t).password.message),1)):g("",!0)])]),s("div",ls,[s("div",ns,[ds,s("div",cs,[p(s("input",y({type:"text",name:"code","onUpdate:modelValue":a[2]||(a[2]=o=>h(n)?n.value=o:null)},e(T),{placeholder:"请输入验证码",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(n)]])]),s("div",rs,[s("span",{class:"cursor-pointer svg",onClick:x,innerHTML:w.value},null,8,us)])]),s("div",ms,[e(t).code?(m(),u("span",_s,v(e(t).code.message),1)):g("",!0)])]),s("div",ps,[s("button",{class:"layui-btn",type:"button",onClick:A}," 立即登录 "),s("span",fs,[k(r,{to:{name:"forget"}},{default:C(()=>[L("忘记密码？")]),_:1})])]),ys])])])])])])])}}};export{ws as default};
