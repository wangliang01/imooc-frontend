import{r as A,x as N,j as Q,b as i,d as s,e as S,w as $,k as p,y as _,z as e,A as f,B as y,t as v,h,p as H,D as O,a as j,o as l,g as z}from"./index-C1-Dz8HJ.js";import{u as E,c as w,a as G,g as Y,r as I}from"./index.esm-CYUsBytH.js";import{u as J,v as K}from"./global-B8WyX3Gp.js";import"./request-DCc2Ix6R.js";import"./local-DJ5KRZrJ.js";const W={class:"layui-container fly-marginTop"},X={class:"fly-panel fly-panel-user",pad20:""},Z={class:"layui-tab layui-tab-brief","lay-filter":"user"},ss={class:"layui-tab-title"},es=s("li",{class:"layui-this"},"注册",-1),as={id:"LAY_ucm",class:"layui-form layui-tab-content",style:{padding:"20px 0"}},os={class:"layui-tab-item layui-show"},ts={class:"layui-form layui-form-pane"},is={class:"layui-form-item"},ls={class:"layui-row"},ns=s("label",{for:"L_email",class:"layui-form-label"},"用户名",-1),rs={class:"layui-input-inline"},cs=s("div",{class:"layui-form-mid layui-word-aux"},"将会成为您唯一的登入名",-1),ds={class:"layui-row"},us={key:0,class:"text-red-600"},ms={class:"layui-form-item"},ps=s("label",{for:"nickname",class:"layui-form-label"},"昵称",-1),_s={class:"layui-input-inline"},fs={class:"layui-form-mid"},ys={key:0,class:"text-red-600"},vs={class:"layui-form-item"},hs={class:"layui-row"},ws=s("label",{for:"L_pass",class:"layui-form-label"},"密码",-1),gs={class:"layui-input-inline"},ks=s("div",{class:"layui-form-mid layui-word-aux"},"6到16个字符",-1),bs={class:"layui-row"},xs={key:0,class:"text-red-600"},Ps={class:"layui-form-item"},Vs={class:"layui-row"},As=s("label",{for:"confirmPassword",class:"layui-form-label"},"确认密码",-1),Cs={class:"layui-input-inline"},Ms={class:"layui-row"},Ts={key:0,class:"text-red-600"},Us={class:"layui-form-item"},qs={class:"layui-row"},Fs=s("label",{for:"code",class:"layui-form-label"},"验证码",-1),Ls={class:"layui-input-inline"},Rs={class:"inline-block"},Bs=["innerHTML"],Ds={class:"layui-form-mid"},Ns={key:0,class:"text-red-600"},Qs=s("div",{class:"layui-form-item fly-form-app"},[s("span",null,"或者直接使用社交账号快捷注册"),s("a",{href:"",onclick:"layer.msg('正在通过QQ登入', {icon:16, shade: 0.1, time:0})",class:"iconfont icon-qq",title:"QQ登入"}),s("a",{href:"",onclick:"layer.msg('正在通过微博登入', {icon:16, shade: 0.1, time:0})",class:"iconfont icon-weibo",title:"微博登入"})],-1),Es={__name:"register",setup(Ss){const x=A(""),g=J(),C=N(),P=A(null),{defineField:n,errors:o,validate:M,resetForm:T}=E({validationSchema:{username:w().required({message:"请输入用户名"}).email({message:"请输入正确的邮箱"}),nickname:w().optional().min(2,{message:"昵称不能少于2位"}).max(10,{message:"昵称不能超过10位"}),password:w().required({message:"请输入密码"}).min(6,{message:"密码不能少于6位"}).max(16,{message:"密码不能超过16位"}),confirmPassword:w().oneOf([G("$password")],{message:"两次输入的密码不一致"}),code:w().required({message:"请输入验证码"}).min(4,{message:"验证码只支持4位"}).max(4,{message:"验证码只支持4位"})}}),[r,U]=n("username",{validateOnModelUpdate:!0}),[c,q]=n("nickname"),[d,F]=n("password"),[u,L]=n("confirmPassword"),[m,R]=n("code"),V=async()=>{const k=g.sid,a=await Y(k);x.value=a},B=()=>{r.value="",c.value="",d.value="",u.value="",m.value="",console.log("resetFields",P.value),T()},D=async k=>{console.log("register"),k.preventDefault();const{valid:a}=await M();if(console.log("valid",a),!a)return!1;const b={username:r.value,nickname:c.value,password:d.value,confirmPassword:u.value,code:m.value,sid:g.sid};console.log("params",b),await I(b),O("注册成功"),B(),setTimeout(()=>{C.push({path:"/login"})},1e3)};return Q(()=>{g.sid||g.setSid(K()),V()}),(k,a)=>{const b=j("router-link");return l(),i("div",W,[s("div",X,[s("div",Z,[s("ul",ss,[s("li",null,[S(b,{to:{name:"login"}},{default:$(()=>[z("登入")]),_:1})]),es]),s("div",as,[s("div",os,[s("div",ts,[s("form",{ref_key:"formRef",ref:P,method:"post"},[s("div",is,[s("div",ls,[ns,s("div",rs,[p(s("input",f({"onUpdate:modelValue":a[0]||(a[0]=t=>y(r)?r.value=t:null),type:"text",name:"username"},e(U),{placeholder:"请输入用户名",autocomplete:"off",class:"layui-input"}),null,16),[[_,e(r)]])]),cs]),s("div",ds,[e(o).username?(l(),i("span",us,v(e(o).username.message),1)):h("",!0)])]),s("div",ms,[ps,s("div",_s,[p(s("input",f({"onUpdate:modelValue":a[1]||(a[1]=t=>y(c)?c.value=t:null),type:"text",name:"nickname"},e(q),{placeholder:"请输入昵称",autocomplete:"off",class:"layui-input"}),null,16),[[_,e(c)]])]),s("div",fs,[e(o).nickname?(l(),i("span",ys,v(e(o).nickname.message),1)):h("",!0)])]),s("div",vs,[s("div",hs,[ws,s("div",gs,[p(s("input",f({"onUpdate:modelValue":a[2]||(a[2]=t=>y(d)?d.value=t:null),type:"password",name:"password"},e(F),{placeholder:"请输入密码",autocomplete:"off",class:"layui-input"}),null,16),[[_,e(d)]])]),ks]),s("div",bs,[e(o).password?(l(),i("span",xs,v(e(o).password.message),1)):h("",!0)])]),s("div",Ps,[s("div",Vs,[As,s("div",Cs,[p(s("input",f({id:"confirmPassword","onUpdate:modelValue":a[3]||(a[3]=t=>y(u)?u.value=t:null),type:"password",name:"confirmPassword"},e(L),{placeholder:"请输入密码",autocomplete:"off",class:"layui-input"}),null,16),[[_,e(u)]])])]),s("div",Ms,[e(o).confirmPassword?(l(),i("span",Ts,v(e(o).confirmPassword.message),1)):h("",!0)])]),s("div",Us,[s("div",qs,[Fs,s("div",Ls,[p(s("input",f({id:"code","onUpdate:modelValue":a[4]||(a[4]=t=>y(m)?m.value=t:null),type:"text",name:"code"},e(R),{placeholder:"请输入验证码",autocomplete:"off",class:"layui-input"}),null,16),[[_,e(m)]])]),s("div",Rs,[s("span",{class:"svg cursor-pointer relative top-[-6px]",onClick:H(V,["stop"]),innerHTML:x.value},null,8,Bs)])]),s("div",Ds,[e(o).code?(l(),i("span",Ns,v(e(o).code.message),1)):h("",!0)])]),s("div",{class:"layui-form-item"},[s("button",{class:"layui-btn",type:"button",onClick:D},"立即注册")]),Qs],512)])])])])])])}}};export{Es as default};
