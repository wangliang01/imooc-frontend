import{r as B,i as N,c as u,b as s,d as k,w as C,j as p,x as f,y as e,z as y,A as h,t as v,g,B as Q,a as S,o as m,f as L}from"./index-C4EGKrBI.js";import{u as U,c as b,l as D,g as F}from"./index.esm-mSbCq2C6.js";import{u as H,v as j}from"./global-COstZxox.js";import"./request-0ae4j7_V.js";const z={class:"mt-5 layui-container fly-marginTop"},E={class:"fly-panel fly-panel-user",pad20:""},G={class:"layui-tab layui-tab-brief","lay-filter":"user"},O={class:"layui-tab-title"},P=s("li",{class:"layui-this"},"登入",-1),R={id:"LAY_ucm",class:"layui-form layui-tab-content",style:{padding:"20px 0"}},Y={class:"layui-tab-item layui-show"},$={class:"layui-form layui-form-pane"},I={method:"post"},J={class:"layui-form-item"},K=s("label",{for:"L_email",class:"layui-form-label"},"用户名",-1),W={class:"layui-input-inline"},X={class:"layui-form-mid"},Z={key:0,class:"text-red-600"},ss={class:"layui-form-item"},es=s("label",{for:"L_pass",class:"layui-form-label"},"密码",-1),as={class:"layui-input-inline"},ts={class:"layui-form-mid"},os={key:0,class:"text-red-600"},is={class:"layui-form-item"},ls={class:"layui-row"},ns=s("label",{for:"L_vercode",class:"layui-form-label"},"验证码",-1),ds={class:"layui-input-inline"},cs={class:""},rs=["innerHTML"],us={class:"layui-form-mid"},ms={key:0,class:"text-red-600"},_s={class:"layui-form-item"},ps={style:{"padding-left":"20px"}},fs=s("div",{class:"layui-form-item fly-form-app"},[s("span",null,"或者使用社交账号登入"),s("a",{href:"",onclick:"layer.msg('正在通过QQ登入', {icon:16, shade: 0.1, time:0})",class:"iconfont icon-qq",title:"QQ登入"}),s("a",{href:"",onclick:"layer.msg('正在通过微博登入', {icon:16, shade: 0.1, time:0})",class:"iconfont icon-weibo",title:"微博登入"})],-1),ws={__name:"index",setup(ys){const w=B(""),{defineField:_,errors:t,validate:V}=U({validationSchema:{username:b().required({message:"请输入用户名"}).email({message:"请输入正确的邮箱"}),password:b().required({message:"请输入密码"}).min(6,{message:"密码不能少于6位"}).max(16,{message:"密码不能超过16位"}),code:b().required({message:"请输入验证码"}).min(4,{message:"验证码只支持4位"}).max(4,{message:"验证码只支持4位"})}}),[i,q]=_("username",{validateOnModelUpdate:!0}),[l,A]=_("password"),[n,M]=_("code"),d=H(),T=async c=>{c.preventDefault();const{valid:a}=await V();if(!a)return!1;const r={username:i.value,password:l.value,code:n.value,sid:d.sid};await D(r),Q("登录成功")},x=async()=>{const c=d.sid,a=await F(c);w.value=a};return N(()=>{d.sid||d.setSid(j()),x()}),(c,a)=>{const r=S("router-link");return m(),u("div",z,[s("div",E,[s("div",G,[s("ul",O,[P,s("li",null,[k(r,{to:{name:"register"}},{default:C(()=>[L("注册")]),_:1})])]),s("div",R,[s("div",Y,[s("div",$,[s("form",I,[s("div",J,[K,s("div",W,[p(s("input",y({"onUpdate:modelValue":a[0]||(a[0]=o=>h(i)?i.value=o:null),type:"text",name:"username"},e(q),{placeholder:"请输入用户名",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(i)]])]),s("div",X,[e(t).username?(m(),u("span",Z,v(e(t).username.message),1)):g("",!0)])]),s("div",ss,[es,s("div",as,[p(s("input",y({"onUpdate:modelValue":a[1]||(a[1]=o=>h(l)?l.value=o:null),type:"password",name:"password"},e(A),{placeholder:"请输入密码",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(l)]])]),s("div",ts,[e(t).password?(m(),u("span",os,v(e(t).password.message),1)):g("",!0)])]),s("div",is,[s("div",ls,[ns,s("div",ds,[p(s("input",y({"onUpdate:modelValue":a[2]||(a[2]=o=>h(n)?n.value=o:null),type:"text",name:"code"},e(M),{placeholder:"请输入验证码",autocomplete:"off",class:"layui-input"}),null,16),[[f,e(n)]])]),s("div",cs,[s("span",{class:"cursor-pointer svg",onClick:x,innerHTML:w.value},null,8,rs)])]),s("div",us,[e(t).code?(m(),u("span",ms,v(e(t).code.message),1)):g("",!0)])]),s("div",_s,[s("button",{class:"layui-btn",type:"button",onClick:T},"立即登录"),s("span",ps,[k(r,{to:{name:"forget"}},{default:C(()=>[L("忘记密码？")]),_:1})])]),fs])])])])])])])}}};export{ws as default};
